# Types et Colonnes

üåç **Languages:** [üá´üá∑ Fran√ßais](types-and-columns.md) | [üá¨üáß English](../../en/entity-mapping/types-and-columns.md)

---

## üìã Table des Mati√®res

- [Vue d'Ensemble](#vue-densemble)
- [Types Num√©riques](#types-num√©riques)
- [Types de Cha√Ænes](#types-de-cha√Ænes)
- [Types de Date et Heure](#types-de-date-et-heure)
- [Types Sp√©ciaux](#types-sp√©ciaux)
- [M√©thodes Utilitaires](#m√©thodes-utilitaires)
- [Guide de S√©lection](#guide-de-s√©lection)
- [Exemples Avanc√©s](#exemples-avanc√©s)

---

## Vue d'Ensemble

MulerTech Database propose un syst√®me de types complet bas√© sur les types de colonnes MySQL. L'enum `ColumnType` offre tous les types support√©s ainsi que des m√©thodes utilitaires pour faciliter leur utilisation.

### üì¶ Import N√©cessaire

```php
<?php
use MulerTech\Database\Mapping\Types\ColumnType;
```

---

## Types Num√©riques

### Types Entiers

```php
enum ColumnType: string
{
    case TINYINT = 'TINYINT';      // -128 √† 127 (ou 0 √† 255 si unsigned)
    case SMALLINT = 'SMALLINT';    // -32,768 √† 32,767 (ou 0 √† 65,535)
    case MEDIUMINT = 'MEDIUMINT';  // -8,388,608 √† 8,388,607 (ou 0 √† 16,777,215)
    case INT = 'INT';              // -2,147,483,648 √† 2,147,483,647 (ou 0 √† 4,294,967,295)
    case BIGINT = 'BIGINT';        // -9,223,372,036,854,775,808 √† 9,223,372,036,854,775,807
}
```

### Types D√©cimaux

```php
enum ColumnType: string
{
    case DECIMAL = 'DECIMAL';      // Nombre d√©cimal exact (recommand√© pour les montants)
    case FLOAT = 'FLOAT';          // Nombre flottant simple pr√©cision
    case DOUBLE = 'DOUBLE';        // Nombre flottant double pr√©cision
}
```

### üìù Exemples d'Utilisation

```php
// ID auto-incr√©ment√©
#[MtColumn(
    columnType: ColumnType::INT,
    isUnsigned: true,
    columnKey: ColumnKey::PRIMARY_KEY,
    extra: 'auto_increment'
)]
private ?int $id = null;

// Prix avec pr√©cision
#[MtColumn(
    columnType: ColumnType::DECIMAL,
    length: 10,        // Pr√©cision : 10 chiffres au total
    scale: 2,          // √âchelle : 2 chiffres apr√®s la virgule
    isUnsigned: true
)]
private float $price;

// Pourcentage
#[MtColumn(
    columnType: ColumnType::FLOAT,
    isUnsigned: true
)]
private float $percentage;
```

---

## Types de Cha√Ænes

### Cha√Ænes de Longueur Fixe/Variable

```php
enum ColumnType: string
{
    case CHAR = 'CHAR';            // Longueur fixe (0-255 caract√®res)
    case VARCHAR = 'VARCHAR';      // Longueur variable (0-65,535 caract√®res)
}
```

### Types de Texte

```php
enum ColumnType: string
{
    case TINYTEXT = 'TINYTEXT';    // Jusqu'√† 255 caract√®res
    case TEXT = 'TEXT';            // Jusqu'√† 65,535 caract√®res
    case MEDIUMTEXT = 'MEDIUMTEXT'; // Jusqu'√† 16,777,215 caract√®res
    case LONGTEXT = 'LONGTEXT';    // Jusqu'√† 4,294,967,295 caract√®res
}
```

### Types Binaires

```php
enum ColumnType: string
{
    case BINARY = 'BINARY';        // Donn√©es binaires longueur fixe
    case VARBINARY = 'VARBINARY';  // Donn√©es binaires longueur variable
    case TINYBLOB = 'TINYBLOB';    // BLOB jusqu'√† 255 octets
    case BLOB = 'BLOB';            // BLOB jusqu'√† 65,535 octets
    case MEDIUMBLOB = 'MEDIUMBLOB'; // BLOB jusqu'√† 16,777,215 octets
    case LONGBLOB = 'LONGBLOB';    // BLOB jusqu'√† 4,294,967,295 octets
}
```

### üìù Exemples d'Utilisation

```php
// Code pays (longueur fixe)
#[MtColumn(
    columnType: ColumnType::CHAR,
    length: 2,
    isNullable: false
)]
private string $countryCode;

// Email (longueur variable)
#[MtColumn(
    columnType: ColumnType::VARCHAR,
    length: 320,
    columnKey: ColumnKey::UNIQUE_KEY
)]
private string $email;

// Description longue
#[MtColumn(columnType: ColumnType::TEXT)]
private ?string $description = null;

// Fichier upload√©
#[MtColumn(columnType: ColumnType::BLOB)]
private ?string $fileData = null;
```

---

## Types de Date et Heure

```php
enum ColumnType: string
{
    case DATE = 'DATE';            // Date uniquement (YYYY-MM-DD)
    case TIME = 'TIME';            // Heure uniquement (HH:MM:SS)
    case DATETIME = 'DATETIME';    // Date et heure (YYYY-MM-DD HH:MM:SS)
    case TIMESTAMP = 'TIMESTAMP';  // Timestamp avec timezone
    case YEAR = 'YEAR';            // Ann√©e uniquement (YYYY)
}
```

### üìù Exemples d'Utilisation

```php
// Date de naissance
#[MtColumn(columnType: ColumnType::DATE)]
private ?DateTime $birthDate = null;

// Heure d'ouverture
#[MtColumn(columnType: ColumnType::TIME)]
private ?DateTime $openingTime = null;

// Date de cr√©ation
#[MtColumn(
    columnType: ColumnType::DATETIME,
    columnDefault: 'CURRENT_TIMESTAMP'
)]
private DateTime $createdAt;

// Derni√®re modification (mise √† jour automatique)
#[MtColumn(
    columnType: ColumnType::TIMESTAMP,
    columnDefault: 'CURRENT_TIMESTAMP',
    extra: 'ON UPDATE CURRENT_TIMESTAMP'
)]
private DateTime $updatedAt;

// Ann√©e de production
#[MtColumn(columnType: ColumnType::YEAR)]
private ?int $productionYear = null;
```

---

## Types Sp√©ciaux

### Types d'√ânum√©ration

```php
enum ColumnType: string
{
    case ENUM = 'ENUM';            // Choix parmi une liste de valeurs
    case SET = 'SET';              // Combinaison de valeurs d'une liste
}
```

### Type JSON

```php
enum ColumnType: string
{
    case JSON = 'JSON';            // Donn√©es JSON (MySQL 5.7.8+)
}
```

### Types G√©om√©triques

```php
enum ColumnType: string
{
    case GEOMETRY = 'GEOMETRY';    // Donn√©es g√©om√©triques g√©n√©riques
    case POINT = 'POINT';          // Point g√©ographique
    case LINESTRING = 'LINESTRING'; // Ligne g√©ographique
    case POLYGON = 'POLYGON';      // Polygone g√©ographique
}
```

### üìù Exemples d'Utilisation

```php
// Statut avec choix limit√©s
#[MtColumn(
    columnType: ColumnType::ENUM,
    choices: ['draft', 'published', 'archived'],
    columnDefault: 'draft'
)]
private string $status;

// Donn√©es JSON
#[MtColumn(columnType: ColumnType::JSON)]
private ?array $metadata = null;

// Coordonn√©es g√©ographiques
#[MtColumn(columnType: ColumnType::POINT)]
private ?string $coordinates = null;
```

---

## M√©thodes Utilitaires

L'enum `ColumnType` fournit des m√©thodes utilitaires pour faciliter son utilisation :

### V√©rification des Propri√©t√©s

```php
// V√©rifier si un type peut √™tre unsigned
if ($columnType->canBeUnsigned()) {
    // Appliquer isUnsigned: true
}

// V√©rifier si un type n√©cessite une longueur
if ($columnType->isTypeWithLength()) {
    // Sp√©cifier le param√®tre length
}

// V√©rifier si un type n√©cessite une pr√©cision
if ($columnType->requiresPrecision()) {
    // Sp√©cifier les param√®tres length (pr√©cision) et scale
}
```

### üìù Exemple d'Utilisation

```php
class ColumnHelper
{
    public function validateColumnDefinition(
        ColumnType $type,
        ?int $length = null,
        ?int $scale = null,
        bool $unsigned = false
    ): bool {
        // V√©rifier si unsigned est applicable
        if ($unsigned && !$type->canBeUnsigned()) {
            throw new InvalidArgumentException(
                "Type {$type->value} ne peut pas √™tre unsigned"
            );
        }
        
        // V√©rifier si la longueur est requise
        if ($type->isTypeWithLength() && $length === null) {
            throw new InvalidArgumentException(
                "Type {$type->value} n√©cessite une longueur"
            );
        }
        
        // V√©rifier la pr√©cision pour les d√©cimaux
        if ($type->requiresPrecision() && $length === null) {
            throw new InvalidArgumentException(
                "Type {$type->value} n√©cessite une pr√©cision"
            );
        }
        
        return true;
    }
}
```

---

## Guide de S√©lection

### Types Num√©riques

| Cas d'Usage | Type Recommand√© | Remarques |
|-------------|-----------------|-----------|
| ID/Cl√© primaire | `INT` unsigned | Auto-increment |
| Compteurs | `INT` unsigned | Valeurs positives |
| Bool√©ens | `TINYINT` | 0/1 ou nullable |
| Prix/Montants | `DECIMAL(10,2)` | Pr√©cision exacte |
| Pourcentages | `FLOAT` | Pr√©cision suffisante |
| Tr√®s grandes valeurs | `BIGINT` | > 2 milliards |

### Types de Texte

| Cas d'Usage | Type Recommand√© | Remarques |
|-------------|-----------------|-----------|
| Noms courts | `VARCHAR(100)` | Longueur adapt√©e |
| Emails | `VARCHAR(320)` | RFC 5321 standard |
| URLs | `VARCHAR(2048)` | Longueur maximale courante |
| Descriptions | `TEXT` | Contenu variable |
| Articles/Contenus | `MEDIUMTEXT` | Gros volumes |
| Codes fixes | `CHAR(n)` | Longueur constante |

### Types de Date

| Cas d'Usage | Type Recommand√© | Remarques |
|-------------|-----------------|-----------|
| Dates simples | `DATE` | Anniversaires, √©ch√©ances |
| Horodatage complet | `DATETIME` | Logs, historique |
| Gestion automatique | `TIMESTAMP` | Created/updated |
| Heures seulement | `TIME` | Horaires, dur√©es |
| Ann√©es seulement | `YEAR` | Archives, statistiques |

---

## Exemples Avanc√©s

### Entit√© E-commerce Compl√®te

```php
#[MtEntity(tableName: 'products')]
class Product
{
    #[MtColumn(
        columnType: ColumnType::INT,
        isUnsigned: true,
        columnKey: ColumnKey::PRIMARY_KEY,
        extra: 'auto_increment'
    )]
    private ?int $id = null;

    #[MtColumn(
        columnType: ColumnType::VARCHAR,
        length: 200,
        isNullable: false
    )]
    private string $name;

    #[MtColumn(
        columnType: ColumnType::CHAR,
        length: 13,
        columnKey: ColumnKey::UNIQUE_KEY
    )]
    private string $sku; // Code produit

    #[MtColumn(
        columnType: ColumnType::DECIMAL,
        length: 10,
        scale: 2,
        isUnsigned: true
    )]
    private float $price;

    #[MtColumn(
        columnType: ColumnType::ENUM,
        choices: ['draft', 'active', 'discontinued'],
        columnDefault: 'draft'
    )]
    private string $status;

    #[MtColumn(columnType: ColumnType::TEXT)]
    private ?string $description = null;

    #[MtColumn(columnType: ColumnType::JSON)]
    private ?array $specifications = null;

    #[MtColumn(
        columnType: ColumnType::INT,
        isUnsigned: true,
        columnDefault: '0'
    )]
    private int $stockQuantity = 0;

    #[MtColumn(columnType: ColumnType::FLOAT)]
    private ?float $weight = null;

    #[MtColumn(
        columnType: ColumnType::TIMESTAMP,
        columnDefault: 'CURRENT_TIMESTAMP'
    )]
    private DateTime $createdAt;

    #[MtColumn(
        columnType: ColumnType::TIMESTAMP,
        columnDefault: 'CURRENT_TIMESTAMP',
        extra: 'ON UPDATE CURRENT_TIMESTAMP'
    )]
    private DateTime $updatedAt;

    // Getters et setters...
}
```

---

## ‚û°Ô∏è √âtapes Suivantes

Pour approfondir votre compr√©hension :

1. üé® [Attributs de Mapping](attributes.md) - Utilisation des attributs
2. üîó [Relations](relationships.md) - Relations entre entit√©s
3. üóÑÔ∏è [Repositories](../../fr/orm/repositories.md) - Gestion des requ√™tes

---

## üîó Liens Utiles

- üè† [Retour au README](../../fr/../README.md)
- üìñ [Documentation Compl√®te](../../fr/README.md)
- üöÄ [D√©marrage Rapide](../../fr/quick-start/installation.md)
